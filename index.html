<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Durham Athletic FC ‚Äì Career Hub</title>

<!-- =========================
     CONFIGURACI√ìN APP / PWA
========================= -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#0b1f3a">

<!-- =========================
     ESTILOS GENERALES
========================= -->
<style>
body {
  font-family: Arial, sans-serif;
  background: #0b1f3a;
  color: #fff;
  margin: 0;
  padding: 20px;
}

h1, h2 {
  color: #f5c542;
}

button {
  padding: 8px 12px;
  margin: 4px;
  border: none;
  cursor: pointer;
  background: #f5c542;
  color: #000;
  font-weight: bold;
}

button.secondary {
  background: #999;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  background: #fff;
  color: #000;
}

th, td {
  border: 1px solid #ccc;
  padding: 6px;
  text-align: center;
}

input {
  width: 100%;
  box-sizing: border-box;
}

.legend {
  padding: 6px;
  cursor: help;
}

.level-3 { color: gold; font-weight: bold; }
.level-2 { color: silver; }
.level-1 { color: #cd7f32; }

.legend small {
  display: block;
  font-size: 0.8em;
  opacity: 0.7;
}
</style>
</head>

<body>

<h1>ü¶Ö Durham Athletic FC ‚Äì Career Hub</h1>

<!-- =========================
     TABLA DE ESTAD√çSTICAS
========================= -->
<h2>üìä Estad√≠sticas por Temporada</h2>

<button onclick="addRow()">‚ûï A√±adir fila</button>
<button onclick="saveData()">üíæ Guardar todo</button>
<button class="secondary" onclick="resetData()">üóëÔ∏è Resetear datos</button>

<table id="stats">
<tr>
  <th>Temporada</th>
  <th>Jugador</th>
  <th>Pos</th>
  <th>PJ</th>
  <th>Goles</th>
  <th>Asist.</th>
  <th>CS</th>
  <th>Media</th>
</tr>
</table>

<datalist id="playersList"></datalist>

<!-- =========================
     RANKINGS
========================= -->
<h2>üèÜ Rankings Hist√≥ricos (TOP 10)</h2>

<h3>‚öΩ M√°ximos Goleadores</h3>
<table id="rankGoals"></table>

<h3>üéØ M√°ximos Asistentes</h3>
<table id="rankAssists"></table>

<h3>üß§ Porter√≠as Imbatidas</h3>
<table id="rankCS"></table>

<!-- =========================
     HALL OF FAME
========================= -->
<h2>üèõÔ∏è Hall of Fame</h2>
<ul id="hallOfFame"></ul>

<!-- =========================
     JAVASCRIPT
========================= -->
<script>
/**************************************************
 * CONFIGURACI√ìN DEL HALL OF FAME (TOCAR AQU√ç)
 **************************************************/
const HOF_RULES = {
  fieldPlayers: {
    goals: 200,
    assists: 100,
    seasons: 5
  },
  goalkeepers: {
    cleanSheets: 150,
    seasons: 5
  }
};

/**************************************************
 * VARIABLES GLOBALES
 **************************************************/
const stats = document.getElementById("stats");
const playersList = document.getElementById("playersList");

/**************************************************
 * A√ëADIR FILA
 **************************************************/
function addRow(){
  const r = stats.insertRow();
  for(let i=0;i<8;i++) r.insertCell();

  r.cells[0].innerHTML = `<input>`;
  r.cells[1].innerHTML = `<input list="playersList">`;
  r.cells[2].innerHTML = `<input placeholder="POR / DC / MC...">`;
  for(let i=3;i<8;i++) r.cells[i].innerHTML = `<input type="number" value="0">`;
}

/**************************************************
 * GUARDAR Y RECALCULAR TODO
 **************************************************/
function saveData(){
  localStorage.stats = stats.innerHTML;
  recalc();
}

/**************************************************
 * RESET TOTAL
 **************************************************/
function resetData(){
  if(confirm("‚ö†Ô∏è Se borrar√°n todos los datos. ¬øSeguro?")){
    localStorage.clear();
    location.reload();
  }
}

/**************************************************
 * REC√ÅLCULO GENERAL
 **************************************************/
function recalc(){
  const players = {};
  playersList.innerHTML = "";

  [...stats.rows].slice(1).forEach(r=>{
    const season = r.cells[0].firstChild.value;
    const name = r.cells[1].firstChild.value;
    const pos = r.cells[2].firstChild.value;
    const pj = +r.cells[3].firstChild.value;
    const g = +r.cells[4].firstChild.value;
    const a = +r.cells[5].firstChild.value;
    const cs = +r.cells[6].firstChild.value;

    if(!name) return;

    if(!players[name]){
      players[name] = { pos, g:0, a:0, cs:0, seasons:new Set() };
      playersList.innerHTML += `<option value="${name}">`;
    }

    players[name].g += g;
    players[name].a += a;
    if(pos === "POR") players[name].cs += cs;
    players[name].seasons.add(season);
  });

  Object.values(players).forEach(p=>p.seasons = p.seasons.size);

  buildTop("rankGoals", players, "g", "Goles");
  buildTop("rankAssists", players, "a", "Asistencias");
  buildTop("rankCS", players, "cs", "Porter√≠as Imbatidas");

  updateHallOfFame(players);
}

/**************************************************
 * RANKINGS TOP 10
 **************************************************/
function buildTop(id, players, key, label){
  const t = document.getElementById(id);
  t.innerHTML = `<tr><th>#</th><th>Jugador</th><th>${label}</th></tr>`;

  Object.entries(players)
    .filter(p=>p[1][key]>0)
    .sort((a,b)=>b[1][key]-a[1][key])
    .slice(0,10)
    .forEach((p,i)=>{
      t.innerHTML += `<tr>
        <td>${i+1}</td>
        <td>${p[0]}</td>
        <td>${p[1][key]}</td>
      </tr>`;
    });
}

/**************************************************
 * HALL OF FAME ‚Äì L√ìGICA AVANZADA
 **************************************************/
function qualifiesForHOF(p){
  if(p.pos === "POR"){
    return p.cs >= HOF_RULES.goalkeepers.cleanSheets ||
           p.seasons >= HOF_RULES.goalkeepers.seasons;
  } else {
    return p.g >= HOF_RULES.fieldPlayers.goals ||
           p.a >= HOF_RULES.fieldPlayers.assists ||
           p.seasons >= HOF_RULES.fieldPlayers.seasons;
  }
}

function legendLevel(p){
  let score = 0;
  if(p.pos === "POR"){
    if(p.cs >= HOF_RULES.goalkeepers.cleanSheets) score++;
    if(p.seasons >= HOF_RULES.goalkeepers.seasons) score++;
  } else {
    if(p.g >= HOF_RULES.fieldPlayers.goals) score++;
    if(p.a >= HOF_RULES.fieldPlayers.assists) score++;
    if(p.seasons >= HOF_RULES.fieldPlayers.seasons) score++;
  }
  return score >= 3 ? 3 : score === 2 ? 2 : 1;
}

function hofReason(p){
  let r = [];
  if(p.pos === "POR"){
    if(p.cs >= HOF_RULES.goalkeepers.cleanSheets) r.push(`${p.cs} CS`);
    if(p.seasons >= HOF_RULES.goalkeepers.seasons) r.push(`${p.seasons} temporadas`);
  } else {
    if(p.g >= HOF_RULES.fieldPlayers.goals) r.push(`${p.g} goles`);
    if(p.a >= HOF_RULES.fieldPlayers.assists) r.push(`${p.a} asistencias`);
    if(p.seasons >= HOF_RULES.fieldPlayers.seasons) r.push(`${p.seasons} temporadas`);
  }
  return r.join(" ¬∑ ");
}

function getHOFDate(name){
  const d = JSON.parse(localStorage.hofDates || "{}");
  if(!d[name]){
    d[name] = new Date().toLocaleDateString();
    localStorage.hofDates = JSON.stringify(d);
  }
  return d[name];
}

function updateHallOfFame(players){
  const hof = document.getElementById("hallOfFame");
  hof.innerHTML = "";

  let legends = [];

  Object.entries(players).forEach(([name,p])=>{
    if(!qualifiesForHOF(p)) return;
    legends.push({
      name,
      level: legendLevel(p),
      reason: hofReason(p),
      date: getHOFDate(name)
    });
  });

  legends.sort((a,b)=>b.level - a.level);

  legends.forEach(l=>{
    hof.innerHTML += `
      <li class="legend level-${l.level}" title="${l.reason}">
        ‚≠ê ${l.name}
        <small>${l.date}</small>
      </li>`;
  });
}

/**************************************************
 * CARGA INICIAL
 **************************************************/
if(localStorage.stats){
  stats.innerHTML = localStorage.stats;
  recalc();
}
</script>

</body>
</html>
